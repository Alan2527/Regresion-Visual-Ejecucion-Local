name:  Regresi칩n Visual - Desktop Prod

# 1. Activaci칩n Manual: Te pedir치 la versi칩n antes de arrancar
on:
  workflow_dispatch:
    inputs:
      version_number:
        description: 'N칰mero de versi칩n a testear (Ej: 170)'
        required: true
        default: '0'

jobs:
  run_regression_local:
    # 2. IMPORTANTE: Esto le dice a GitHub que use TU m치quina
    runs-on: self-hosted

    steps:
      # 3. Descarga el repositorio en tu m치quina (en la carpeta _work del runner)
      - name: 拘勇 Checkout del c칩digo
        uses: actions/checkout@v4

      # 4. Ejecuci칩n del Script
      # Python ya est치 instalado en tu m치quina, as칤 que lo llamamos directo.
      # Se pasa el input 'version_number' que recibe tu script en sys.argv[1]
      - name: 游 Ejecutar Regresi칩n Visual
        run: |
          py regre_visual_tn_desk_prod.py ${{ inputs.version_number }}

      # 5. Subir los resultados a GitHub
      # El script guarda los reportes en "Reportes HTML - TN - DESKTOP - PROD"
      # Usamos 'if: always()' para que suba el reporte aunque el test falle.
      - name: 拘勇 Subir Reportes y Capturas
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: Reporte-Regresion-v${{ inputs.version_number }}-${{ github.run_id }}
          path: "Reportes HTML - TN - DESKTOP - PROD"
          retention-days: 5
